

-- Recursive query to display the employee hierarchy
-- Assumes a table structure like:
-- Employees(id INT PRIMARY KEY, name VARCHAR, manager_id INT)

WITH RECURSIVE EmployeeHierarchy AS (
    -- Anchor member: select top-level employees (no manager)
    SELECT
        id,
        name,
        manager_id,
        1 AS level,
        CAST(name AS VARCHAR(1000)) AS path
    FROM Employees
    WHERE manager_id IS NULL

    UNION ALL

    -- Recursive member: select employees reporting to the previous level
    SELECT
        e.id,
        e.name,
        e.manager_id,
        eh.level + 1,
        CAST(eh.path || ' > ' || e.name AS VARCHAR(1000))
    FROM Employees e
    INNER JOIN EmployeeHierarchy eh ON e.manager_id = eh.id
)
SELECT
    id,
    name,
    manager_id,
    level,
    path
FROM EmployeeHierarchy
ORDER BY path;